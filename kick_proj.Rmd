---
title: "Can you kickstart?"
author: "JG"
date: "2/10/2022"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Prep & Review

```{r Load Libraries}
library(tidyverse)
library(lubridate)
library(ggplot2)


```

```{r Load Data}

#### Load data from file ------------------------------------------------------

ks_b <- read.csv('Kickstarter_Campaigns_DataSet.csv')
head(ks_b)
str(ks_b)
summary(ks_b)


#### Filter and Column Formatting ------------------------------------------------------

ks <- ks_b %>% 
  #remove projects with goal under 1$
  filter(goal_usd>1) %>%
  #filter for completed projects only
  filter(status=='successful'|status=='failed') %>%
  #format date strings into date class
  mutate(launched_at=mdy_hm(launched_at)) %>%
  mutate(deadline=mdy_hm(deadline)) %>%
  #extract elements from launch date and deadline
  mutate(launch_year=year(launched_at)) %>% 
  mutate(launch_month=month(launched_at)) %>%
  mutate(launch_dom=day(launched_at)) %>%
  mutate(launch_dow=wday(launched_at)) %>%
  mutate(launch_hour=hour(launched_at)) %>%
  mutate(dead_year=year(deadline)) %>% 
  mutate(dead_month=month(deadline)) %>% 
  mutate(dead_dom=day(deadline)) %>% 
  mutate(dead_dow=wday(deadline)) %>%
  mutate(dead_hour=hour(deadline)) %>% 
  #calculate percent funded
  mutate(pct_funded=usd_pledged/goal_usd) %>%
  #calculates average pledge amount
  mutate(avg_plg.bkr=ifelse(backers_count > 0,usd_pledged/backers_count,0)) %>%
  #name counts
  mutate(name_len=str_length(name)) %>%
  mutate(name_wrd=sapply(strsplit(name," "),length)) %>%
  #binary status field for modeling
  mutate(status_binary=ifelse(status=='successful',1,0))

summary(ks)
#no null values in any field

```

## EDA


```{r id}
#unremarkable 
```

```{r name}

#--- name length ---------------------------------------------------------------
ks %>%
  ggplot(aes(x=name_len, col=status)) +
  geom_density()
#if this trend is real...interesting

ks %>%
  ggplot(aes(x=name_len, fill=status)) +
  geom_histogram(position=position_dodge(1.7),alpha=1,col='grey3') +
  theme_classic()
# confirmed via histogram

ks %>%
  ggplot() +
  geom_point(aes(y=log(goal_usd),x=name_len,col=status), size=.01)

# name length, count of each, scale size bu pct success

#--- name length x success w/ goal ----

ks %>%
  group_by(name_len) %>%
  summarize(n(),
            avg_goal=mean(goal_usd),
            avg_backers=mean(backers_count),
            succ_rate=sum(status=='successful')/n()) %>%
  ggplot() +
  geom_point(aes(x=name_len,y=succ_rate,size=avg_goal,color=avg_backers)) +
  labs(title='Name Length vs Project Success',x='Characters in Name',y='Success Rate',
       size="Average Goal USD", color="Average Backer Count") +
  theme_linedraw()
  #there appears to be a sweet spot for name length - 40-60 characters
  #right side of graph may be due to low sample size, plot color as density


#USE THIS
ks %>%
  group_by(name_len) %>%
  summarize(total=n(),
            avg_goal=mean(goal_usd),
            avg_backers=mean(backers_count),
            succ_rate=sum(status=='successful')/n()) %>%
  ggplot() +
  geom_point(aes(x=name_len,y=succ_rate,size=avg_goal,color=total)) +
  labs(title='Name Length vs Project Success',x='Characters in Name',y='Success Rate',
       size="Average Goal USD", color="Count") +
  theme_linedraw() +
  scale_color_gradient(low='grey',high='firebrick4') +
  scale_x_continuous(breaks=seq(0,90,by=5))


#--- name word ---------------------------------------------------------------
ks %>%
  ggplot(aes(x=name_wrd, col=status)) +
  geom_density() +
 scale_x_continuous(limits=c(0,40),breaks=seq(0,40)) 
#lol fake, just density plot being dumb

ks %>%
  ggplot(aes(x=name_wrd, fill=status)) +
  geom_histogram(alpha=.5,position=position_dodge(.7))
# similar trends, tons more at length 7

ks %>%
  group_by(name_wrd) %>%
  summarize(total=n(),
            avg_goal=mean(goal_usd),
            avg_backers=mean(backers_count),
            succ_rate=sum(status=='successful')/n()) %>%
  ggplot() +
  geom_point(aes(x=name_wrd,y=succ_rate,size=avg_goal,color=total)) +
  theme_linedraw()
  #same as above, count seems more important that backer count


#USE THIS
ks %>%
  group_by(name_wrd) %>%
  summarize(total=n(),
            avg_goal=mean(goal_usd),
            avg_backers=mean(backers_count),
            succ_rate=sum(status=='successful')/n()) %>%
  ggplot() +
  geom_point(aes(x=name_wrd,y=succ_rate,size=avg_goal,color=total)) +
  labs(title='Name Word Count vs Project Success',x='Words in Name',y='Success Rate',
       size="Average Goal USD", color="Count") +
  theme_linedraw() +
  scale_color_gradient(low='grey',high='firebrick4')


#--- name word*char ---------------------------------------------------------------


ks %>%
  ggplot(aes(x=name_len,y=name_wrd)) + 
  geom_point(aes(color=status),size=1)


ks %>%
  ggplot(aes(x=name_len/name_wrd)) + 
  geom_density(aes(fill=status),alpha=.4) +
  theme_linedraw()+
  labs(title='Average Word Length',x='Chars in Word',y='Density') +  
  xlim(0,20)

ks %>% group_by(status) %>% summarize(mean(name_len/name_wrd))
#  status     `mean(name_len/name_wrd)`
#   <chr>                          <dbl>
# 1 failed                          6.48
# 2 successful                      6.21
##
#average name length for projects is 6.3

```


```{r currency & country}
## currency -------------------------------------------------------------

ks %>% 
  group_by(currency) %>% 
  summarize(total=n(), succ_rate=sum(status=='successful')/total) %>%
  ggplot(aes(x=currency,y=succ_rate)) +
  geom_point(aes(size=total)) +
  ylim(0,1)


## country -------------------------------------------------------------

ks %>% 
  group_by(country) %>% 
  summarize(total=n(), succ_rate=sum(status=='successful')/total) %>%
  ggplot(aes(x=country,y=succ_rate)) +
  geom_point(aes(size=total)) +
  theme_linedraw() +
  ylim(0,1)

#country and currency seem to track pretty closely - report just one?
cor(ks$country, ks$currency)
#need to convert to numbers
unq_ctry <- data.frame(country=unique(ks$country),country_code=seq(1:length(unique(ks$country))))
unq_ctry
unq_curr <- data.frame(currency=unique(ks$currency),currency_code=seq(1:length(unique(ks$currency))))
unq_curr

cur.cnt <- ks %>% 
  inner_join(unq_ctry,by='country') %>% 
  inner_join(unq_curr,by='currency')

cor(cur.cnt$country_code,cur.cnt$currency_code)
# 0.927% correlation - going to drop currency from analysis



country <- ks %>% group_by(country) %>% summarize(total=n(),
                                       succ_rate=sum(status=='successful')/total,
                                       avg_goal=mean(goal_usd),
                                       avg_pct_fund=mean(pct_funded),
                                       avg_bkrs=mean(backers_count))

country

#success rate (and relative number of projects)
country %>%
  ggplot(aes(x=country)) +
  geom_point(aes(y=succ_rate)) + 
  geom_point(aes(y=total/sum(total)*5),shape=1) +
  ylim(0,1)
#usa percentage of projects is not listed

#avg_goal
country %>%
  ggplot(aes(x=country)) +
  geom_point(aes(y=succ_rate)) + 
  geom_point(aes(y=avg_goal/1e6),shape=1)
# china is an ourlier but still manage similar success rate

#avg_pct_fund
country %>%
  ggplot(aes(x=country)) +
  geom_point(aes(y=avg_pct_fund))
#usa percentage of projects is not listed

#avg_bkrs
country %>%
  ggplot(aes(x=country)) +
  geom_point(aes(y=succ_rate)) + 
  geom_point(aes(y=avg_bkrs/1e4),shape=1)


```


```{r id}
## launched_at -------------------------------------------------------------
# break into discrete elements for analysis - DONE

## backers_count -------------------------------------------------------------
# some projects have no backers - eliminate? [decided not to but will report in backer stats]
ks %>% count(backers_count==0)  
#   backers_count == 0      n
# 1              FALSE 189684
# 2               TRUE  13163
13163/(13163+189684) #~6.5% of projects have no backers

ks %>% group_by(status) %>% count(backers_count==0)  
#   status     `backers_count == 0`      n
#   <chr>      <lgl>                 <int>
# 1 failed     FALSE                 63281
# 2 failed     TRUE                  13163
# 3 successful FALSE                126403
13163/(13163+63281) #17% of failed projects have no backers
# huge difference between IQR and max value
# investigate

## blurb ----------------------------------------------------------------------
# unremarkable


## deadline ----------------------------------------------------------------------
# break into discrete elements for analysis - DONE

## slug ----------------------------------------------------------------------
# unremarkable

## status ----------------------------------------------------------------------
# unremarkable

## usd_pledged ----------------------------------------------------------------------
# huge disparity between IQR and max
# think about how relevant this value is when thinking about project success
# the quantity itself doesnt seem relevant but instead how it relates to the goal
# and means of acieving the goal - what's the pct funded and pledge per backer!

## sub_category ----------------------------------------------------------------------
# unremarkable

## main_category ----------------------------------------------------------------------
# unremarkable

## creator_id ----------------------------------------------------------------------
# unremarkable

## blurb_length ----------------------------------------------------------------------
#unremarkable

## goal_usd ---------------------------------------------------------------------
# IQR way low compared to max - outlines?
summary(ks$goal_usd)

ks %>% group_by(status) %>% summarize(max(goal_usd),total_projs=n(),'goal_2m' = sum(goal_usd>=2e6),'pct_2m'=goal_2m/total_projs)
#   status     `max(goal_usd)` total_projs goal_2m    pct_2m
#   <chr>                <dbl>       <int>   <int>     <dbl>
# 1 failed           135403380       76444     295 0.00386  
# 2 successful         2000000      126403       4 0.0000316
####
# there were 251 unsuccessful proj >2m (44 failed at 2m)

# noticed in graphical analysis there were projects with goal <=1, should I remove?
# check country/currency first
ks_b %>% filter(goal_usd<=1) %>% group_by(country) %>%summarize(n())  #274 US, 25 other
ks_b %>% filter(goal_usd<=1) %>% group_by(currency) %>%summarize(n()) #274 US, 25 other
#removal seems OK

## city ---------------------------------------------------------------------------------------------------------------
# unremarkable
# potentially overlay heat map of projects

## duration ----------------------------------------------------------------------
# very tightly grouped around 30 days
# 98 days outlier?




```





```{r cars}
##############################################################################
##
## Status
##
##############################################################################

ks %>% 
  group_by(status) %>% 
  summarise(total=n()) %>%
  ggplot(aes(x="",y=total,fill=status)) + 
  geom_bar(stat='identity',width=1,color='white') + 
  coord_polar('y',start=0) +
  theme_void()

##############################################################################
##
## Funding Goal & % Pledged
##
##############################################################################


summary(ks$goal_usd)
#      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#         0      1400      4716     36880     12000 135403380

ks %>% group_by(status) %>% summarize(mean(goal_usd),max(goal_usd),median(goal_usd))
#   status     `mean(goal_usd)` `max(goal_usd)` `median(goal_usd)`
#   <chr>                 <dbl>           <dbl>              <dbl>
# 1 failed               83216.       135403380               6800
# 2 successful            8858.         2000000               3500

ks %>%
  ggplot(aes(x=goal_usd)) +
  geom_histogram(aes(fill=status,line='black'), bins=10, position='dodge')
# not useful


#---------------------------------------------------------------------
#      goal_usd
#----------------------------------------------------------------------

#--- Density Plots/goal_usd ----

#filter for 200k (max for successful)
ks %>% filter(goal_usd<2e5) %>%
  ggplot(aes(x=goal_usd)) +
  geom_density(aes(fill=status), alpha = .4)
# better - confirms cheaper projects much more likely to be succesful

ks %>% filter(goal_usd<1e5) %>%
  ggplot(aes(x=goal_usd)) +
  geom_density(aes(fill=status), alpha = .4)

#filter for values close to mean of successful projects
ks %>% filter(goal_usd<1e4) %>%
  ggplot(aes(x=goal_usd)) +
  geom_density(aes(fill=status), alpha = .4)


#--- Box Plots/goal_usd

ks %>%
  ggplot(aes(x=fct_reorder(status,goal_usd),y=goal_usd)) +
  geom_violin(aes(fill=status)) +
  geom_boxplot(alpha=.5)
#long tail of unsuccessful projects masks


ks %>%
  ggplot(aes(x=fct_reorder(status,goal_usd),y=log(goal_usd))) +
  geom_violin(aes(fill=status)) +
  geom_boxplot(alpha=.5)
# Overlap between IQRs, medians are veyr close (on log scale)
# success has low tail, failed has high

ks %>% filter(goal_usd<=2e5) %>%
  ggplot(aes(x=fct_reorder(status,goal_usd),y=goal_usd)) +
  geom_violin(aes(fill=status)) #+
  geom_boxplot(alpha=.5)
#ugly (hide box?) but demonstrates point- cheap projects are easier to make successful
#primary analaysis - acknowledge that cheap projects will succeed
#seconday analysis - consider what makes more expensive projects successful
#(look at things like google search trends)

#---------------------------------------------------------------------
#      pct_funded
#----------------------------------------------------------------------

  
#--- Density Plot/pct_funded

ks %>% filter(goal_usd<1e5,pct_funded<5) %>%
  ggplot(aes(x=pct_funded)) +
  geom_density(aes(fill=status), alpha = .4)
#vast majority of funded projects do not exceed 200% of goal

#--- Histogram/pct_funded

ks %>% filter(status=='successful') %>%
  ggplot(aes(x=log(pct_funded))) + 
  geom_histogram(aes(),col='white') 

#---------------------------------------------------------------------
#      goal_usd x pct_funded
#----------------------------------------------------------------------


#--- Scatter Plot/pct_funded*goal_usd ---

ks %>%
  ggplot(aes(x=goal_usd,y=pct_funded)) + 
  geom_point(aes(color=status))

ks %>%
  ggplot(aes(x=log(goal_usd),y=log(pct_funded))) + 
  geom_point(aes(color=status),size=.01)
#would this be reason to omit projects with no funding from the analysis?
#what is a better way to interpret this?


ks %>% group_by(status) %>% summarize(sum(pct_funded<.1),sum(pct_funded<.01),sum(pct_funded<.001),sum(pct_funded<.0001))
#   status     `sum(pct_funded < 0.1)` `sum(pct_funded < 0.01)` `sum(pct_funded < 0.001)` `sum(pct_funded < 1e-04)`
#   <chr>                        <int>                    <int>                     <int>                     <int>
# 1 failed                       58359                    38026                     24742                     16997
# 2 successful                       0                        0                         0                         0

ks %>%
  split(.$status) %>%
  map(summary)


#--- Scatter/pct_funded and backers

ks %>%
  ggplot(aes(x=log(pct_funded),y=(avg_plg.bkr))) + 
  geom_point(aes(color=status),size=.01)
#pattern break at funding line probably has to do with shift in backer behavior
#tendency to make low pledge to follow a project, recieve updates and adjust in last 24 of campaign
#interesting that pledge per backer is HIGHER for projects near 100% funding

ks %>%
  ggplot(aes(x=log(goal_usd),y=(avg_plg.bkr))) + 
  geom_point(aes(color=status),size=.01)


ks %>%
  ggplot(aes(x=log(pct_funded),y=(backers_count))) + 
  geom_point(aes(color=status),size=.01)


##############################################################################
##
## Backer Stats
##
##############################################################################

#--- Pledge per backer stats

ks %>% group_by(status) %>% summarise(mean(avg_plg.brk))
#   status     `mean(avg_plg.brk)`
#   <chr>                    <dbl>
# 1 failed                    47.1
# 2 successful                92.1
ks %>% filter(backers_count>0) %>% group_by(status) %>% summarise(mean(avg_plg.brk))
#   status     `mean(avg_plg.brk)`
#   <chr>                    <dbl>
# 1 failed                    56.9
# 2 successful                92.1

#excluding backers brings average pledge per backer up by ~25%


# --- Investigating campaigns with no backers

ks %>% count(backers_count==0)  
#   backers_count == 0      n
# 1              FALSE 189684
# 2               TRUE  13163
13163/(13163+189684) #~6.5% of projects have no backers

ks %>% group_by(status) %>% count(backers_count==0)  
#   status     `backers_count == 0`      n
#   <chr>      <lgl>                 <int>
# 1 failed     FALSE                 63281
# 2 failed     TRUE                  13163
# 3 successful FALSE                126403
13163/(13163+63281) #17% of failed projects have no backers!!!

ks %>%
  ggplot() +
  geom_density(aes(x=backers_count,fill=status),alpha=.4) +
  xlim(0,500)

ks %>%
  ggplot() +
  geom_density(aes(x=backers_count,fill=status),alpha=.4) +
  xlim(0,200)

ks %>%
  ggplot() +
  geom_density(aes(x=log(backers_count),fill=status),alpha=.4)
#sub in actual values on axis


ks %>%
  ggplot() +
  geom_density(aes(x=usd_pledged/backers_count,fill=status),alpha=.4) +
  xlim(0,500)
```


```{r cars}
##############################################################################
##
## Categories
##
##############################################################################

# x = categories, y = goal, success rate

sub_cat <- ks %>% 
  group_by(sub_category) %>%
  summarise(pct_succ=sum(pct_funded>=1)/n(),
            avg_goal=mean(goal_usd),
            avg_bkrs=mean(backers_count),
            avg_plg=mean(avg_plg.bkr))
sub_cat

#category vs success/goal
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_goal/1e5),shape=1) 

#category vs backer count
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ)))+
  geom_point(aes(y=avg_bkrs/10))
#captured by scale 0-600
#adjust to show in 10s, scale to match avg_goal

#category vs backer count
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ)))+
  geom_point(aes(y=avg_plg))
#captured by scale 0-140

#category vs goal
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ)))+
  geom_point(aes(y=avg_goal/1000))
#high of 100k - change to plot in thousands, captured by scale 0-100

sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Goal in Thousands USD")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_goal/100000),col='green4',shape=1)

sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Average Pledge")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_plg/100),col='green4',shape=1)



#redo - plot % success vs goal, color dots by category, scale size by number of projects ####################################################!!!!!!!

sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Average Backer Count")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_bkrs/100),col='green4',shape=1)


sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Counts")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_goal/100000),col='green4',shape=1) +  #circles
  geom_point(aes(y=avg_bkrs/100),col='green4',shape=2) +     #triangles
  geom_point(aes(y=avg_plg/100),col='green4',shape=3)        #plus
#this plot loses tech stuff

#--- by main category


ks %>% 
  group_by(main_category) %>%
  summarise(pct_succ=sum(pct_funded>=1)/n())


?sec_axis

##############################################################################
##
## Launch Timing
##
##############################################################################

ks %>%
  group_by(launch_year) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_year,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(2009,2020),breaks=seq(2009,2020)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())
#interesting drop in 2014 then trending back up
#roll in new data if time permits

p_lm <- ks %>%
  group_by(launch_month) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_month,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,12),breaks=seq(1,12)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ldom <- ks %>%
  group_by(launch_dom) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_dom,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,31),breaks=seq(1,31)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ldow <- ks %>%
  group_by(launch_dow) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_dow,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,7),breaks=seq(1,7)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_lhour <- ks %>%
  group_by(launch_hour) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_hour,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(0,23),breaks=seq(0,23),
                     sec.axis = sec_axis(~.-5, name="EST")) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

library(gridExtra)
grid.arrange(p_lm,p_ldom,p_ldow,p_lhour, nrow=2)

######################################################################################look at statistical significance of these points
######################################################################################what timezone is this in? UTC, consider converting (in app automatically convert)
######################################################################################### second axis with local time

##############################################################################
##
## Deadline
##
##############################################################################

ks %>%
  group_by(dead_year) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_year,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(2009,2020),breaks=seq(2009,2020)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())
#interesting drop in 2014 then trending back up
#roll in new data if time permits

p_dm <- ks %>%
  group_by(dead_month) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_month,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,12),breaks=seq(1,12)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ddom <- ks %>%
  group_by(dead_dom) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_dom,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,31),breaks=seq(1,31)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ddow <- ks %>%
  group_by(dead_dow) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_dow,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,7),breaks=seq(1,7)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_dhour <- ks %>%
  group_by(dead_hour) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_hour,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(0,23),breaks=seq(0,23)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

grid.arrange(p_dm,p_ddom,p_ddow,p_dhour, nrow=2)


##############################################################################
##
## Duration
##
##############################################################################


ks %>% group_by(status) %>% summarize(mean(duration),min(duration),max(duration),median(duration))
#   status     `mean(duration)` `min(duration)` `max(duration)` `median(duration)`
#   <chr>                 <dbl>           <int>           <int>              <dbl>
# 1 failed                 35.5               1              92                 30
# 2 successful             31.1               1              98                 30

ks %>%
  ggplot() +
  geom_density(aes(x=duration,fill=status),alpha=.4)

ks %>%
  ggplot()+
  geom_point(aes(x=duration,y=log(goal_usd),col=status),size=.01)

ks %>%
  ggplot() +
  geom_boxplot(aes(y=duration,x=status))





##############################################################################
##
## Creator Experience
##
##############################################################################


#creators with more than one project

creator <- ks %>% 
  group_by(creator_id) %>% 
  summarise(total_proj=n(),
            succ_rate=sum(status=='successful')/total) %>%
  filter(total_proj>1)

creator %>%
  ggplot() +
  geom_point(aes(x=total,y=succ_rate))

#------------
creator2 <- ks %>% 
  group_by(creator_id,status) %>% 
  summarise(total_proj=n()) %>%
  filter(total_proj>1)

creator2
  
creator2 %>%
  ggplot() +
  geom_density(aes(x=total_proj,fill=status),alpha=.4) +
  xlim(0,20)

#--------------------
creator3 <- ks %>% 
  group_by(creator_id,status) %>% 
  summarise(total_proj=n())

creator3
  
creator3 %>%
  ggplot() +
  geom_density(aes(x=total_proj,fill=status),alpha=.4) +
  xlim(0,10)
# this is kinda interesting
#should be 0 to 1
# plot 1 proj vs more than one

##############################################################################
##
## Project Name and Blurb Characteristics
##
##############################################################################

#boxplots
?stringr

ks$name[1] %>% str_length()
#name lenght
#num words
#stringr count strings
```

# name and blurb



```

## Build a model















```{r log_model}
summary(ks)

plot(ks)

##
## Notes ------------------------------------------------------
##


#backers_count, usd_pledged, and avg_plg.bkr are too interdependant. 
#is usd_pledged useful? it feels somewhat redundant with goal_usd, as being over_funded doesn't inform the answer of success any more than the combination of goal_usd and status do
#similarly, pct_funded does not seem useful

#ignoring city and country. you could psuedo-launch from anywhere and likely has confounding data.


##
## All Vars ------------------------------------------------------
##

#backers_count + country + usd_pledged + sub_category + main_category + goal_usd + duration + launch_month + launch_dom + +launch_dow + launch_hour + name_len + name_wrd

logit.overall = glm(status_binary ~backers_count + country + usd_pledged + sub_category + main_category + goal_usd + duration + launch_month + launch_dom + +launch_dow + launch_hour + name_len + name_wrd,
                    family = 'binomial',
                    data = ks)

scatter.smooth(logit.overall$fit,
               residuals(logit.overall, type = "deviance"),
               lpars = list(col = "red"),
               xlab = "Fitted Probabilities",
               ylab = "Deviance Residual Values",
               main = "Residual Plot for\nLogistic Regression of Admission Data")

exp(logit.overall$coefficients)

summary(logit.overall2)


##
## reduced vars ------------------------------------------------------
##


logit.overall2 = glm(status_binary ~ backers_count + sub_category + goal_usd + duration + launch_month + launch_dom + +launch_dow + launch_hour + name_len + name_wrd,
                    family = 'binomial',
                    data = ks)


scatter.smooth(logit.overall2$fit,
               residuals(logit.overall2, type = "deviance"),
               lpars = list(col = "red"),
               xlab = "Fitted Probabilities",
               ylab = "Deviance Residual Values",
               main = "Residual Plot for\nLogistic Regression of Admission Data")

exp(logit.overall2$coefficients)

summary(logit.overall2)

##
## elim insignificant values ------------------------------------------------------
##


logit.overall3 = glm(status_binary ~ backers_count + sub_category + goal_usd + duration + name_wrd,
                    family = 'binomial',
                    data = ks)


scatter.smooth(logit.overall3$fit,
               residuals(logit.overall3, type = "deviance"),
               lpars = list(col = "red"),
               xlab = "Fitted Probabilities",
               ylab = "Deviance Residual Values",
               main = "Residual Plot for\nLogistic Regression of Admission Data")

exp(logit.overall3$coefficients)

summary(logit.overall3)

#the deviance is the same for all 3 models
#is my data bad? too many outliers?
#would it be easier if I restricted to a smaller size
```


```{r log_model_reduced_goal}


ks.r <- ks %>% filter(goal_usd<50000)

logit.overall.r = glm(status_binary ~backers_count + country + usd_pledged + sub_category + main_category + goal_usd + duration + launch_month + launch_dom + +launch_dow + launch_hour + name_len + name_wrd,
                    family = 'binomial',
                    data = ks.r)

scatter.smooth(logit.overall.r$fit,
               residuals(logit.overall.r, type = "deviance"),
               lpars = list(col = "red"),
               xlab = "Fitted Probabilities",
               ylab = "Deviance Residual Values",
               main = "Residual Plot for logt.overall.r")

exp(logit.overall$coefficients)

summary(logit.overall2)



```
