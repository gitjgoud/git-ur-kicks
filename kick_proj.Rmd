---
title: "Can you kickstart?"
author: "JG"
date: "2/10/2022"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
ks_b <- read.csv('Kickstarter_Campaigns_DataSet.csv')
head(ks_b)
class(ks_b)
summary(ks_b)
str(ks_b)

library(tidyverse)
library(lubridate)


##############################################################################
##
## cleaning and review
##
##############################################################################

#fix dates and extract m/d/y, filter status
ks <- ks_b %>% 
  #format date strings into date class
  mutate(launched_at=mdy_hm(launched_at)) %>%
  #extract elements from launch date and deadline
  mutate(launch_year=year(launched_at)) %>% 
  mutate(launch_month=month(launched_at)) %>%
  mutate(launch_dom=day(launched_at)) %>%
  mutate(launch_dow=wday(launched_at)) %>%
  mutate(launch_hour=hour(launched_at)) %>%
  mutate(deadline=mdy_hm(deadline)) %>% 
  mutate(dead_year=year(deadline)) %>% 
  mutate(dead_month=month(deadline)) %>% 
  mutate(dead_dom=day(deadline)) %>% 
  mutate(dead_dow=wday(deadline)) %>%
  mutate(dead_hour=hour(deadline)) %>% 
  #filter for projects that are completed and not canceled
  filter(status=='successful'|status=='failed') %>%
  #calculate percent funded
  mutate(pct_funded=usd_pledged/goal_usd) %>%
  #calculates average pledge amount
  mutate(avg_plg.bkr=ifelse(backers_count > 0,usd_pledged/backers_count,0)) %>%
  #remove projects with goal under 1$
  filter(goal_usd>1)


# ----- review column summary ---------------------------------------------
summary(ks)
#no null values

## id
#unremarkable

## name
# unremarkable

## currency
# unremarkable

## launched_at
# break into discrete elements for analysis

## backers_count -------------------------------------------------------------
# some projects have no backers - eliminate?
ks %>% count(backers_count==0)  
#   backers_count == 0      n
# 1              FALSE 189684
# 2               TRUE  13163
13163/(13163+189684) #~6.5% of projects have no backers

ks %>% group_by(status) %>% count(backers_count==0)  
#   status     `backers_count == 0`      n
#   <chr>      <lgl>                 <int>
# 1 failed     FALSE                 63281
# 2 failed     TRUE                  13163
# 3 successful FALSE                126403
13163/(13163+63281) #17% of failed projects have no backers!!! ###############################################report on this
# huge difference between IQR and max value
# investigate

## blurb ----------------------------------------------------------------------
# unremarkable

## country
# unremarkable

## deadline
# break into discrete elements for analysis

## slug
# unremarkable

## status
# unremarkable

## usd_pledged
# huge disparity between IQR and max
# compare to amt pledged, backers

## sub_category
# unremarkable

## main_category
# unremarkable

## creator_id
# unremarkable
# look for repeat projects by same creator


## blurb_length
# what is this? slug lenght?

## goal_usd ---------------------------------------------------------------------
# IQR way low compared to max
summary(ks$goal_usd)

ks %>% group_by(status) %>% summarize(max(goal_usd),total_projs=n(),'goal_2m' = sum(goal_usd>=2e6),'pct_2m'=goal_2m/total_projs)
#   status     `max(goal_usd)` total_projs goal_2m    pct_2m
#   <chr>                <dbl>       <int>   <int>     <dbl>
# 1 failed           135403380       76444     295 0.00386  
# 2 successful         2000000      126403       4 0.0000316

ks %>% count(goal_usd < 1)
#goals for under $1 will be removed and considered unreal

## city ---------------------------------------------------------------------------------------------------------------
# unremarkable

## duration
# very tightly grouped around 30 days
# 98 days outlier?




```





```{r cars}
##############################################################################
##
## Funding Goal & % Pledged
##
##############################################################################


summary(ks$goal_usd)
#      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#         0      1400      4716     36880     12000 135403380

ks %>% group_by(status) %>% summarize(mean(goal_usd),max(goal_usd),median(goal_usd))
#   status     `mean(goal_usd)` `max(goal_usd)` `median(goal_usd)`
#   <chr>                 <dbl>           <dbl>              <dbl>
# 1 failed               83216.       135403380               6800
# 2 successful            8858.         2000000               3500

ks %>%
  ggplot(aes(x=goal_usd)) +
  geom_histogram(aes(fill=status,line='black'), bins=10, position='dodge')
# not useful


#--- Density Plots/goal_usd ----

#filter for 200k (max for successful)
ks %>% filter(goal_usd<2e5) %>%
  ggplot(aes(x=goal_usd)) +
  geom_density(aes(fill=status), alpha = .4)
# better - confirms cheaper projects much more likely to be succesful

ks %>% filter(goal_usd<1e5) %>%
  ggplot(aes(x=goal_usd)) +
  geom_density(aes(fill=status), alpha = .4)

#filter for values close to mean of successful projects
ks %>% filter(goal_usd<1e4) %>%
  ggplot(aes(x=goal_usd)) +
  geom_density(aes(fill=status), alpha = .4)


#--- Box Plots/goal_usd

ks %>%
  ggplot(aes(x=fct_reorder(status,goal_usd),y=goal_usd)) +
  geom_violin(aes(fill=status)) +
  geom_boxplot(alpha=.5)
#long tail of unsuccessful projects masks


ks %>%
  ggplot(aes(x=fct_reorder(status,goal_usd),y=log(goal_usd))) +
  geom_violin(aes(fill=status)) +
  geom_boxplot(alpha=.5)
# Overlap between IQRs, medians are veyr close (on log scale)
# success has low tail, failed has high

ks %>% filter(goal_usd<=2e5) %>%
  ggplot(aes(x=fct_reorder(status,goal_usd),y=goal_usd)) +
  geom_violin(aes(fill=status)) #+
  geom_boxplot(alpha=.5)
#ugly (hide box?) but demonstrates point- cheap projects are easier to make successful
#primary analaysis - acknowledge that cheap projects will succeed
#seconday analysis - consider what makes more expensive projects successful
#(look at things like google search trends)

#--- Density Plot/pct_funded

ks %>% filter(goal_usd<1e5,pct_funded<5) %>%
  ggplot(aes(x=pct_funded)) +
  geom_density(aes(fill=status), alpha = .4)
#vast majority of funded projects do not exceed 200% of goal

#--- Histogram/pct_funded

ks %>% filter(status=='successful') %>%
  ggplot(aes(x=log(pct_funded))) + 
  geom_histogram(aes(),col='white') 

ks %>% filter(status=='successful') %>%
  ggplot(aes(x=log(pct_funded))) + 
  geom_density() 

#--- Scatter Plot/pct_funded*goal_usd ---

ks %>%
  ggplot(aes(x=goal_usd,y=pct_funded)) + 
  geom_point(aes(color=status))

ks %>%
  ggplot(aes(x=log(goal_usd),y=log(pct_funded))) + 
  geom_point(aes(color=status),size=.01)
#would this be reason to omit projects with no funding from the analysis?


ks %>% group_by(status) %>% summarize(sum(pct_funded<.1),sum(pct_funded<.01),sum(pct_funded<.001),sum(pct_funded<.0001))
#   status     `sum(pct_funded < 0.1)` `sum(pct_funded < 0.01)` `sum(pct_funded < 0.001)` `sum(pct_funded < 1e-04)`
#   <chr>                        <int>                    <int>                     <int>                     <int>
# 1 failed                       58359                    38026                     24742                     16997
# 2 successful                       0                        0                         0                         0

ks %>%
  split(.$status) %>%
  map(summary)


#--- Scatter/pct_funded and backers

ks %>%
  ggplot(aes(x=log(pct_funded),y=(avg_plg.bkr))) + 
  geom_point(aes(color=status),size=.01)
#pattern break at funding line probably has to do with shift in backer behavior
#tendency to make low pledge to follow a project, recieve updates and adjust in last 24 of campaign
#interesting that pledge per backer is HIGHER for projects near 100% funding

ks %>%
  ggplot(aes(x=log(pct_funded),y=(backers_count))) + 
  geom_point(aes(color=status),size=.01)


ks %>%
  ggplot(aes(x=log(pct_funded),y=(backers_count))) + 
  geom_point(aes(color=status),size=.01)


##############################################################################
##
## Backer Stats
##
##############################################################################

#--- Pledge per backer stats

ks %>% group_by(status) %>% summarise(mean(avg_plg.brk))
#   status     `mean(avg_plg.brk)`
#   <chr>                    <dbl>
# 1 failed                    47.1
# 2 successful                92.1
ks %>% filter(backers_count>0) %>% group_by(status) %>% summarise(mean(avg_plg.brk))
#   status     `mean(avg_plg.brk)`
#   <chr>                    <dbl>
# 1 failed                    56.9
# 2 successful                92.1

#excluding backers brings average pledge per backer up by ~25%


# --- Investigating campaigns with no backers

ks %>% count(backers_count==0)  
#   backers_count == 0      n
# 1              FALSE 189684
# 2               TRUE  13163
13163/(13163+189684) #~6.5% of projects have no backers

ks %>% group_by(status) %>% count(backers_count==0)  
#   status     `backers_count == 0`      n
#   <chr>      <lgl>                 <int>
# 1 failed     FALSE                 63281
# 2 failed     TRUE                  13163
# 3 successful FALSE                126403
13163/(13163+63281) #17% of failed projects have no backers!!!

#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! look for trends in categories
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! look for trends in launch timing
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! look for trends in goals/funded - DONE


##############################################################################
##
## Categories
##
##############################################################################

# x = categories, y = goal, success rate

sub_cat <- ks %>% 
  group_by(sub_category) %>%
  summarise(pct_succ=sum(pct_funded>=1)/n(),
            avg_goal=mean(goal_usd),
            avg_bkrs=mean(backers_count),
            avg_plg=mean(avg_plg.bkr))
sub_cat

#category vs success/goal
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_goal/1e5),shape=1) 

#category vs backer count
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ)))+
  geom_point(aes(y=avg_bkrs/10))
#captured by scale 0-600
#adjust to show in 10s, scale to match avg_goal

#category vs backer count
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ)))+
  geom_point(aes(y=avg_plg))
#captured by scale 0-140

#category vs goal
sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ)))+
  geom_point(aes(y=avg_goal/1000))
#high of 100k - change to plot in thousands, captured by scale 0-100

sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Goal in Thousands USD")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_goal/100000),col='green4',shape=1)

sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Average Pledge")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_plg/100),col='green4',shape=1)

sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Average Pledge")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_bkrs/100),col='green4',shape=1)


sub_cat %>%
  ggplot(aes(x=reorder(sub_category, pct_succ))) +
  scale_y_continuous(name='% Success', limits=c(0,1), sec.axis = sec_axis(~ 100*., name="Counts")) +
  geom_point(aes(y=pct_succ)) +
  geom_point(aes(y=avg_goal/100000),col='green4',shape=1) +  #circles
  geom_point(aes(y=avg_bkrs/100),col='green4',shape=2) +     #triangles
  geom_point(aes(y=avg_plg/100),col='green4',shape=3)        #plus
#this plot loses tech stuff

#--- by main category


ks %>% 
  group_by(main_category) %>%
  summarise(pct_succ=sum(pct_funded>=1)/n())


?sec_axis


##############################################################################
##
## Launch Timing
##
##############################################################################

ks %>%
  group_by(launch_year) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_year,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(2009,2020),breaks=seq(2009,2020)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())
#interesting drop in 2014 then trending back up
#roll in new data if time permits

p_lm <- ks %>%
  group_by(launch_month) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_month,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,12),breaks=seq(1,12)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ldom <- ks %>%
  group_by(launch_dom) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_dom,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,31),breaks=seq(1,31)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ldow <- ks %>%
  group_by(launch_dow) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_dow,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,7),breaks=seq(1,7)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_lhour <- ks %>%
  group_by(launch_hour) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=launch_hour,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(0,23),breaks=seq(0,23),
                     sec.axis = sec_axis(~.-5, name="EST")) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

library(gridExtra)
grid.arrange(p_lm,p_ldom,p_ldow,p_lhour, nrow=2)

######################################################################################look at statistical significance of these points
######################################################################################what timezone is this in? UTC, consider converting (in app automatically convert)
######################################################################################### second axis with local time

##############################################################################
##
## Deadline
##
##############################################################################

ks %>%
  group_by(dead_year) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_year,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(2009,2020),breaks=seq(2009,2020)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())
#interesting drop in 2014 then trending back up
#roll in new data if time permits

p_dm <- ks %>%
  group_by(dead_month) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_month,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,12),breaks=seq(1,12)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ddom <- ks %>%
  group_by(dead_dom) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_dom,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,31),breaks=seq(1,31)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_ddow <- ks %>%
  group_by(dead_dow) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_dow,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(1,7),breaks=seq(1,7)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

p_dhour <- ks %>%
  group_by(dead_hour) %>%
  summarize(ct_succ=sum(status=='successful'),
            ct_fail=sum(status=='failed'),
            pct_succ=ct_succ/n()) %>%
  ggplot(aes(x=dead_hour,y=pct_succ)) +
  geom_point() +
  scale_x_continuous(limits=c(0,23),breaks=seq(0,23)) +
  ylim(c(0,1)) +
  theme(panel.grid.minor=element_blank())

grid.arrange(p_dm,p_ddom,p_ddow,p_dhour, nrow=2)


##############################################################################
##
## Duration
##
##############################################################################


ks %>% group_by(status) %>% summarize(mean(duration),min(duration),max(duration),median(duration))
#   status     `mean(duration)` `min(duration)` `max(duration)` `median(duration)`
#   <chr>                 <dbl>           <int>           <int>              <dbl>
# 1 failed                 35.5               1              92                 30
# 2 successful             31.1               1              98                 30

ks %>%
  ggplot() +
  geom_density(aes(x=duration,fill=status),alpha=.4)

ks %>%
  ggplot()+
  geom_point(aes(x=duration,y=log(goal_usd),col=status),size=.01)

ks %>%
  ggplot() +
  geom_boxplot(aes(y=duration,x=status))


##############################################################################
##
## Location
##
##############################################################################





##############################################################################
##
## Creator Experience
##
##############################################################################



##############################################################################
##
## Project Name and Blurb Characteristics
##
##############################################################################

#boxplots


##############################################################################
##
## Funding Goal
##
##############################################################################



```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
